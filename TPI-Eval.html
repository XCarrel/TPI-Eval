<!DOCTYPE html>
<html lang="fr_FR.UTF-8">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TPI-Eval</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />

    <script>
      var evals = [];
    </script>
    <style>
      .text {
        margin: 2px;
      }
      .row {
        width: 100%;
        display: flex;
        flex-direction: row;
        break-inside: avoid;
      }
      .col-1 {
        width: 8%;
      }
      .col-2 {
        width: 17%;
      }
      .col-6 {
        width: 50%;
      }
      .col-7 {
        width: 56%;
      }
      .col-8 {
        width: 66%;
      }
      .d-none {
        display: none;
      }
      .cell {
        padding: 3px;
        border-bottom: 1px solid black;
        border-right: 1px solid black;
      }
      .header {
        background-color: #aaaaaa;
      }

      .table {
        margin: 1px;
        border-top: 1px solid black;
        border-left: 1px solid black;
      }
      .bold {
        font-weight: bolder;
      }

      textarea,
      input[type="text"] {
        border: none;
        background-color: lightgray;
        width: 95%;
        padding: 3px;
        font-family: Calibri;
      }
      .points {
        width: 30px;
        border: none;
        background-color: lightgray;
        text-align: center;
      }
      #divGrade {
        background-color: lightgray;
        font-size: larger;
        border: 1px solid black;
      }
      .value {
        font-weight: bold;
        padding: 4px;
        text-align: left;
      }
      .center {
        text-align: center;
      }
      td {
        width: 60px;
        text-align: center;
      }
      th {
        background-color: #aaaaaa;
      }
      tr:nth-child(even) {
        background-color: #f2f2f2;
      }
      .button {
        padding: 10px;
        border-radius: 4px;
        background-color: #1e81b0;
        text-align: center;
        color: white;
        width: 70px;
        margin: 3px;
      }
      .disabledbutton {
        padding: 10px;
        border-radius: 4px;
        background-color: #6f9fb6;
        text-align: center;
        color: white;
        width: 70px;
        margin: 3px;
      }
      .delbutton {
        background-color: white;
        color: red;
        border: none;
        float: right;
      }
      @media print {
        .pagebreak {
          page-break-before: always;
        } /* page-break-after works, as well */
        .noprint {
          display: none;
        }
        div {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      }

      body {
        font-family: Calibri;
      }

      /* Modal stuff, directly from w3schools */
      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0, 0, 0); /* Fallback color */
        background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
      }

      /* Modal Content */
      .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
      }

      /* The Close Button */
      .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }

      .close:hover,
      .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div id="divSelector">
      Reprendre une évaluation existante
      <select id="dpdEvalSelector">
        <option value="-1">--- Choisir ---</option>
      </select>
      ou
      <button id="cmdEmpty">Page blanche</button>
    </div>
    <div id="divPage" class="d-none">
      <!-- ======================================================================================== -->
      <div class="row">
        <div id="cmdFreeze" class="button noprint">Finaliser</div>
        <div id="cmdExport" class="button noprint">Exporter</div>
      </div>
      <!-- ======================================================================================== -->
      <div id="divHeader">
        <p>Procédure de qualification : 88600/1/2/3 Informaticienne CFC/Informaticien CFC (Ordonnance 2014)</p>
        <p>Formulaire d’évaluation Candidat/-e:<span class="value" id="spnCandidate"></span></p>
        <hr />
      </div>
      <!-- ======================================================================================== -->
      <div id="divCartouche">
        <div class="table">
          <div class="row">
            <div class="cell col-6 bold">
              Entreprise formatrice/Chef·fe de Projet:
              <div><input tabindex="1" id="txtBoss" type="text" /></div>
            </div>
            <div class="cell col-6 bold">
              Candidat·e:
              <div><input tabindex="4" id="txtCandidate" type="text" /></div>
            </div>
          </div>
          <div class="row">
            <div class="cell col-6">
              Téléphone:
              <div><input tabindex="2" id="txtBossPhone" type="text" /></div>
            </div>
            <div class="cell col-6">
              Téléphone:
              <div><input tabindex="5" id="txtCandidatePhone" type="text" /></div>
            </div>
          </div>
          <div class="row">
            <div class="cell col-6">
              Email:
              <div><input tabindex="3" id="txtBossMail" type="text" /></div>
            </div>
            <div class="cell col-6">
              Email:
              <div><input tabindex="6" id="txtCandidateMail" type="text" /></div>
            </div>
          </div>
        </div>
        <br />
        <div class="table">
          <div class="row">
            <div class="cell col-6 bold">
              Expert·e 1
              <div><input tabindex="7" id="txtExpert1" type="text" /></div>
            </div>
            <div class="cell col-6 bold">
              Expert·e 2
              <div><input tabindex="10" id="txtExpert2" type="text" /></div>
            </div>
          </div>
          <div class="row">
            <div class="cell col-6">
              Téléphone:
              <div><input tabindex="8" id="txtExpert1Phone" type="text" /></div>
            </div>
            <div class="cell col-6">
              Téléphone:
              <div><input tabindex="11" id="txtExpert2Phone" type="text" /></div>
            </div>
          </div>
          <div class="row">
            <div class="cell col-6">
              Email:
              <div><input tabindex="9" id="txtExpert1Mail" type="text" /></div>
            </div>
            <div class="cell col-6">
              Email:
              <div><input tabindex="12" id="txtExpert2Mail" type="text" /></div>
            </div>
          </div>
        </div>
      </div>
      <div class="text">
        <p>Ce document ne doit en aucun cas être montré au candidat après l’attribution des points.</p>
        <p class="bold">Conseils pour l’évaluation et l’attribution de la note</p>
        <p class="bold">Documentation</p>
        <p>
          Les experts/expertes traitent tous les documents de manière confidentielle. La conservation des dossiers est
          régie par le droit cantonal.
        </p>
        <p class="bold">Evaluation</p>
        <p>
          Le/la chef/-e de projet du TPI et les experts/expertes évaluent les compétences professionnelles élargies, le
          résultat et les compétences professionnelles.
        </p>
        <p>L’évaluation du TPI est répartie comme suit :</p>
        <p><span class="bold">Partie A:</span> Compétences professionnelles (20 critères)</p>
        <ul>
          <li>6 critères relatifs à l’analyse et au concept</li>
          <li>7 critères relatifs à la réalisation, aux tests et au résultats du TPI</li>
          <li>7 critères spécifiques à la tâche demandée par le supérieur professionnel</li>
        </ul>
        <p><span class="bold">Partie B:</span> Documentation / rapport du TPI (10 critères)</p>
        <p><span class="bold">Partie C:</span> Entretien professionnel et présentation (10 critères)</p>
      </div>
      <!-- ======================================================================================== -->

      <h2 class="pagebreak">Partie A: Compétences professionnelles</h2>
      <div id="tblProComp" class="table" data-part="A">
        <div class="row">
          <div class="cell header col-1"></div>
          <div class="cell header col-7">Question</div>
          <div class="cell header col-1">Pt</div>
          <div class="cell header col-7">Justification</div>
        </div>
      </div>
      <!-- ======================================================================================== -->

      <h2 class="pagebreak">Partie B: Documentation / rapport du TPI</h2>
      <div id="tblDoc" class="table" data-part="B">
        <div class="row">
          <div class="cell header col-1"></div>
          <div class="cell header col-7">Question</div>
          <div class="cell header col-1">Pt</div>
          <div class="cell header col-7">Justification</div>
        </div>
      </div>
      <!-- ======================================================================================== -->

      <h2 class="pagebreak">Partie C: Entretien professionnel et présentation</h2>
      <div id="tblPres" class="table" data-part="C">
        <div class="row">
          <div class="cell header col-1"></div>
          <div class="cell header col-7">Question</div>
          <div class="cell header col-1">Pt</div>
          <div class="cell header col-7">Justification</div>
        </div>
      </div>
      <button id="cmdAddQuestion">+</button>
      <!-- ======================================================================================== -->

      <h2 class="pagebreak">Contraction</h2>
      <div class="table">
        <div class="row">
          <div class="cell col-8 bold">Sommes des différentes parties</div>
          <div class="cell col-2 bold">Nombre de points max</div>
          <div class="cell col-2 bold">Points obtenus</div>
        </div>
        <div class="row">
          <div class="cell col-8">Partie A: Compétences professionnelles</div>
          <div class="cell col-2 center">60</div>
          <div id="divTotalA" class="cell col-2 center"></div>
        </div>
        <div class="row">
          <div class="cell col-8">Partie B: Documentation / rapport du TPI</div>
          <div class="cell col-2 center">30</div>
          <div id="divTotalB" class="cell col-2 center"></div>
        </div>
        <div class="row">
          <div class="cell col-8">Partie C: Entretien professionnel et présentation</div>
          <div class="cell col-2 center">30</div>
          <div id="divTotalC" class="cell col-2 center"></div>
        </div>
        <div class="row bold">
          <div class="cell col-8">Somme de A + B + C</div>
          <div class="cell col-2 center">120</div>
          <div id="divTotal" class="cell col-2 center"></div>
        </div>
        <div class="row bold">
          <div class="cell col-8">Note (5 * somme / 120) + 1</div>
          <div id="divGrade" class="cell col-2 center"></div>
          <div class="cell col-2 center"></div>
        </div>
      </div>
      <!-- ======================================================================================== -->
      <br />
      <div class="center">
        <table id="tblGrades" style="border-collapse: collapse">
          <tr>
            <th>Points</th>
            <th>Note</th>
            <th>Points</th>
            <th>Note</th>
            <th>Points</th>
            <th>Note</th>
            <th>Points</th>
            <th>Note</th>
            <th>Points</th>
            <th>Note</th>
          </tr>
          <tr>
            <td>0-1</td>
            <td>1,0</td>
            <td>23-25</td>
            <td>2,0</td>
            <td>47-49</td>
            <td>3,0</td>
            <td>71-73</td>
            <td>4,0</td>
            <td>95-97</td>
            <td>5,0</td>
          </tr>
          <tr>
            <td>2-3</td>
            <td>1,1</td>
            <td>26-27</td>
            <td>2,1</td>
            <td>50-51</td>
            <td>3,1</td>
            <td>74-75</td>
            <td>4,1</td>
            <td>98-99</td>
            <td>5,1</td>
          </tr>
          <tr>
            <td>4-5</td>
            <td>1,2</td>
            <td>28-29</td>
            <td>2,2</td>
            <td>52-53</td>
            <td>3,2</td>
            <td>76-77</td>
            <td>4,2</td>
            <td>100-101</td>
            <td>5,2</td>
          </tr>
          <tr>
            <td>6-8</td>
            <td>1,3</td>
            <td>30-32</td>
            <td>2,3</td>
            <td>54-56</td>
            <td>3,3</td>
            <td>78-80</td>
            <td>4,3</td>
            <td>102-104</td>
            <td>5,3</td>
          </tr>
          <tr>
            <td>9-10</td>
            <td>1,4</td>
            <td>33-34</td>
            <td>2,4</td>
            <td>57-58</td>
            <td>3,4</td>
            <td>81-82</td>
            <td>4,4</td>
            <td>105-106</td>
            <td>5,4</td>
          </tr>
          <tr>
            <td>11-13</td>
            <td>1,5</td>
            <td>35-37</td>
            <td>2,5</td>
            <td>59-61</td>
            <td>3,5</td>
            <td>83-85</td>
            <td>4,5</td>
            <td>107-109</td>
            <td>5,5</td>
          </tr>
          <tr>
            <td>14-15</td>
            <td>1,6</td>
            <td>38-39</td>
            <td>2,6</td>
            <td>62-63</td>
            <td>3,6</td>
            <td>86-87</td>
            <td>4,6</td>
            <td>110-111</td>
            <td>5,6</td>
          </tr>
          <tr>
            <td>16-17</td>
            <td>1,7</td>
            <td>40-41</td>
            <td>2,7</td>
            <td>64-65</td>
            <td>3,7</td>
            <td>88-89</td>
            <td>4,7</td>
            <td>112-113</td>
            <td>5,7</td>
          </tr>
          <tr>
            <td>18-20</td>
            <td>1,8</td>
            <td>42-44</td>
            <td>2,8</td>
            <td>66-68</td>
            <td>3,8</td>
            <td>90-92</td>
            <td>4,8</td>
            <td>114-116</td>
            <td>5,8</td>
          </tr>
          <tr>
            <td>21-22</td>
            <td>1,9</td>
            <td>45-46</td>
            <td>2,9</td>
            <td>69-70</td>
            <td>3,9</td>
            <td>93-94</td>
            <td>4,9</td>
            <td>117-118</td>
            <td>5,9</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>119-120</td>
            <td>6,0</td>
          </tr>
        </table>
      </div>
      <!-- ======================================================================================== -->
      <h2>Remarques</h2>
      <div><textarea tabindex="998" id="txtRemarks"></textarea></div>
      <div style="display: flex; flex-direction: column; margin: 25px">
        <div class="bold" style="display: flex; justify-content: space-around">
          <div style="font-style: italic">Signatures</div>
          <div>
            Chef·fe de projet<br />
            <span style="font-size: small; font-style: italic; font-weight: normal">(lieu et date)</span>
          </div>
          <div>
            Expert·e 1<br />
            <span style="font-size: small; font-style: italic; font-weight: normal">(lieu et date)</span>
          </div>
          <div>
            Expert·e 2<br />
            <span style="font-size: small; font-style: italic; font-weight: normal">(lieu et date)</span>
          </div>
        </div>
        <div style="display: flex; justify-content: space-around">
          <div style="height: 80px; width: 20%"></div>
          <div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
          <div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
          <div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
        </div>
      </div>
    </div>
    <!-- The Modal popup, adapted from w3schools -->
    <div id="popup" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <div class="close">&times;</div>
        <div id="divModalContent"></div>
      </div>
    </div>
  </body>

  <script>
    evals = JSON.parse(localStorage.getItem("evals"));
    // Build dropdown list of evals
    if (evals) {
      evals.forEach(function (eval, i) {
        let opt = document.createElement("option");
        opt.innerText = eval.cartouche.candidate.name;
        opt.value = i;
        dpdEvalSelector.appendChild(opt);
      });
    } else {
      evals = [];
      divSelector.className = "d-none";
      divPage.classList.remove("d-none");
      isCloseable();
    }
    var criteria = [
      {
        id: "A1",
        title: "Gestion de projet et planification ",
        help: "Les mandats complexes sont résolus à l’aide d’une méthode de gestion de projets. Pour les travaux pratiques également, il convient d’analyser les relations, de planifier le système cible, de comparer les variantes et d’élaborer un plan d’action.<br><h3>Niveau de qualité 3</h3>1. La méthode de gestion de projet choisie est citée dans le rapport. La méthode est appropriée au mandat.<br>2. La méthode de gestion de projet a été correctement mise en œuvre en pratique durant le TPI.<br>3. L’utilisation correcte de la méthode de projet est visible dans la documentation.<br>4. Le mandat du cahier des charges a été analysé de manière approfondie et affiné. Les 4 points sont remplis entièrement<br><h3>Niveau de qualité 2</h3>Trois des points mentionnés sont accomplis<br><h3>Niveau de qualité 1</h3>Deux des points mentionnés sont accomplis<br><h3>Niveau de qualité 0</h3> Uniquement un ou aucun des points mentionnés ne sont accomplis. "
      },
      {
        id: "A2",
        title: "Acquisition du savoir ",
        help: "Les informations à disposition sont aussi multiples que variées. Le ou la candidat-e peut sélectionner les supports et les canaux d’informations en fonction de la tâche à exécuter, évaluer les informations et les exploiter conformément au but recherché.<br><h3>Niveau de qualité 3</h3>1. Le journal de travail, le rapport de projet ou le protocole des discussions avec le supérieur professionnel démontrent clairement l’acquisition de connaissances<br>2. Sélectionne les sources d'informations alignées aux besoins de ses tâches.<br>3. Choisit judicieusement les sources d'informations et les utilise (transfert du savoir).<br>4. Les sources sont clairement référencées et les parties prenantes au projet peuvent facilement reconstruire le processus d’acquisition de connaissances.<br><h3>Niveau de qualité 2</h3>Trois des critères d'évaluation précités sont remplis.<br><h3>Niveau de qualité 1</h3>Deux des critères d'évaluation précités sont remplis.<br><h3>Niveau de qualité 0</h3> Moins de deux des critères d'évaluation sont remplis. "
      },
      {
        id: "A3",
        title: "Calendrier / planification ",
        help: "Afin de pouvoir contrôler l’avancement du travail et d’identifier suffisamment tôt des écarts par rapport au calendrier fixé, une comparaison régulière est effectuée entre la situation actuelle et la situation escomptée.Niveau de qualité 3<br>1. Un axe temporel absolu a été défini (Date)<br>2. L'axe temporel est structuré de manière raisonnable (Blocs de 2 ou 4 heures)<br>3. Des activités appropriées ont été formées. Elles couvrent l'entier du travail à réaliser.<br>4. L’ordre de déroulement des tâches est judicieux.<br>5. La répartition du temps des activités est planifiée de manière réaliste.<br>6. La comparaison entre la planification initiale et l’état actuel est transparente et correcte. Les 6 points sont remplis et correctement décrits<br><h3>Niveau de qualité 2</h3>Quatre ou cinq des points mentionnés sont remplis<br><h3>Niveau de qualité 1</h3>Deux ou trois des points mentionnés sont remplis<br><h3>Niveau de qualité 0</h3> Un seul ou aucun des points mentionnés n’est rempli."
      },
      {
        id: "A4",
        title: "Compréhension conceptuelle ",
        help: "L’énoncé de la tâche, son contexte et le développement de solutions peuvent être présentés de façon simplifiée à l’aide de concepts ou de modèles. A cet égard, les détails sont sciemment laissés de côté et seul l’essentiel est montré (p. ex. points clés, lignes directrices, obstacles).<br><h3>Niveau de qualité 3</h3>1. Définit des concepts ou des modèles structurants<br>2. Les principaux aspects structurants du mandat sont mis en évidence.<br>3. Démontre (dans le rapport du TPI, lors de la présentation ou dans le cadre d’une discussion technique)<br>4. Connait bien les interactions entre les parties/sous-systèmes du travail a réaliser.<br><h3>Niveau de qualité 2</h3>Les deux premiers points ainsi que les points trois ou quatre sont remplis.<br><h3>Niveau de qualité 1</h3>Les deux premiers points sont remplis<br><h3>Niveau de qualité 0</h3> Le point 1 n’est pas rempli "
      },
      {
        id: "A5",
        title: "Environnement de projet : limites du système / interfaces avec le monde extérieur ",
        help: "L’intégration du mandat dans son environnement est documentée.<br><h3>Niveau de qualité 3</h3>Le candidat connait les limites de l'environnement de son projet et peut les décrire. Il connait en détail les différentes interfaces et les a documentées.<br><h3>Niveau de qualité 2</h3>Le candidat connaît les interfaces mais ne sait que partiellement ce qu'elles engendrent ou elles ne sont que partiellement documentées.<br><h3>Niveau de qualité 1</h3>Le candidat se représente vaguement l'environnement et ne connaît pas les interfaces ou ne les a quasiment pas documentées.<br><h3>Niveau de qualité 0</h3> Le candidat ne porte attention qu'à son projet et ne s'inquiète/ne sait pas ce qui se passe dans l'environnement proche du projet ou n’a rien documenté. "
      },
      {
        id: "A6",
        title: "Test de la solution (planification et exécution) ",
        help: "Chaque solution doit être testée avant sa remise. Un concept de tests est élaboré à cet effet. Il décrit ce qui va être testé et comment.<br><h3>Niveau de qualité 3</h3>1. Le concept de test contient le périmètre (environnement)<br>2. ... un scenario de test (script) comprenant des cas de tests pertinents<br>3. ... les moyens et les méthodes de tests utilisées<br>4. ... les résultats attendus<br>5. Les tests décrits ci-dessus ont tous été effectués<br><h3>Niveau de qualité 2</h3>Quatre des aspects cités sont bien remplis.<br><h3>Niveau de qualité 1</h3>Trois des aspects sont bien remplis ou la solution a été vérifiée sans concept de tests.<br><h3>Niveau de qualité 0</h3> Moins de trois aspects sont bien remplis. "
      },
      {
        id: "A7",
        title: "Volonté de performance / engagement / attitude au travail / mise en œuvre ",
        help: "Le ou la candidat-e fait montre de sa volonté de performance non seulement par sa persévérance et sa flexibilité, mais aussi en traitant de façon adéquate les résultats de son travail dans le cadre du mandat confié. Les connaissances acquises à l’école et en entreprise sont utilisées dans différentes situations et permettent d’entreprendre des actions selon les objectifs visés.<br><h3>Niveau de qualité 3</h3>L’élaboration des résultats du travail montre que le candidat réfléchit au- delà de la donnée du problème et complète les éléments manquants ce qui montre qu’il comprend la tâche dans son ensemble. Le candidat utilise son temps et ses compétences pour obtenir des résultats optimaux dans son travail. Il connaît les bases théoriques des techniques utilisées et a pu les utiliser de la meilleure manière dans le cadre du TPI. Son approche des problématiques démontre une démarche ciblée de l’objectif à atteindre.<br><h3>Niveau de qualité 2</h3>L’élaboration des résultats du travail montre que le candidat réfléchit au- delà de la donnée du problème et complète les éléments manquants ce qui montre qu’il comprend la tâche dans son ensemble. Le candidat utilise son temps et ses compétences pour obtenir de bons résultats dans son travail. Il connaît les bases théoriques des techniques utilisées mais ne les utilise pas toujours de manière adéquate. Son approche des problématiques ne démontre pas toujours une démarche ciblée de l’objectif a atteindre.<br><h3>Niveau de qualité 1</h3>L’élaboration des résultats démontre que le candidat se donne de la peine à réaliser la donnée du problème à satisfaction. Le candidat utilise son temps et ses compétences pour obtenir des résultats de travail suffisants. Il oublie parfois de porter attention au temps qui s’écoule et se satisfait de résultats se trouvant à un stade de réalisation précoce. Les bases théoriques néccessaires sont lacunaires et rendent difficile l’atteinte d’une approche ciblée de la démarche pour atteindre l’objectif.<br><h3>Niveau de qualité 0</h3> Dans l’élaboration des résultats du travail il est difficile de vérifier que le candidat s’est donné de la peine pour accomplir la tâche de manière satisfaisante. Il n’investit du temps et n’utilise ses compétences que sur demande et fournit des résultats limite satisfaisants ou de qualité discutable. Il oublie de porter attention au temps écoulé ou se satisfait de résultats qui nécessitent d’être retravaillés à plusieurs reprises. Les connaissances théoriques sont lacunaires ou absentes. "
      },
      {
        id: "A8",
        title: "Autonomie de travail",
        help: "Le ou la candidat-e se procure et élabore les informations requises, cherche des variantes de solution et prend des décisions de façon compétente et professionnelle. Il ou elle répartit son travail et détermine ainsi le bon déroulement de son TPI.<br><h3>Niveau de qualité 3</h3>1. Sait distinguer l’essentiel du superflu et établir des priorités<br>2. Il utilise les moyens dont il dispose et arrive à les utiliser de manière autonome pour obtenir les informations nécessaires.<br>3. N’a besoin d’aucun soutien injustifié d’autres professionnels.<h3>Niveau de qualité 2</h3>Deux des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Un des points est rempli ou les trois sont en partie remplis.<br><h3>Niveau de qualité 0</h3> Aucun des points n’est rempli. Ou le candidat ne demande aucune information ou aide supplémentaire, bien que cela aurait été nécessaire pour la progression et la réussite de son travail. "
      },
      {
        id: "A9",
        title: "Connaissances professionnelles et application adéquate ",
        help: "L’expert se distingue du néophyte dans la mesure où ses actions sont guidées par l’application cohérente du savoir acquis en fonction d’une situation donnée. Il ne sait pas seulement ce qu’il fait, mais aussi pourquoi et comment procéder correctement. Un travail efficient exige de bien connaître les méthodes et les produits requis et de maîtriser leur utilisation.<br><h3>Niveau de qualité 3</h3>Le candidat a démontré tout au long de son travail, qu’il dispose des connaissances professionnelles de base et des connaissances techniques nécessaires à ses tâches et qu’il les applique de façon cohérente dans chaque situation. Le candidat applique avec assurance les compétences nécessaires à l’utilisation des produits mis en oeuvre pour atteindre l’objectif fixé et le fait de manière routinière et sans aucune erreur.<br><h3>Niveau de qualité 2</h3>Des déclarations incertaines ou imprécises de terminologies ou connaissances professionnelles démontrent des faiblesses. Le candidat n’utilise les connaissances nécessaires aux produits utilisés uniquement au moyen de détours ou de recherches et la mise en oeuvre est parfois fastidieuse et il ne sait pas comment les utiliser.<br><h3>Niveau de qualité 1</h3>Le candidat élude la question ou fait des déclarations erronées. Il répond par des déclarations basées sur des préjugés irréfléchis ou des opinions personnelles qui démontrent de grandes lacunes au niveau des connaissances professionnelles. Le candidat utilise les produits mis en œuvre de manière incomplète, incertaine et superficielle. Il n’utilise parfois pas les bons produits qui ne sont pas adaptés pour l’atteinte de l’objectif.<br><h3>Niveau de qualité 0</h3> Le candidat ne connait pas les bases techniques nécessaires à la réalisation de son travail ou il ne fait pas le lien avec ce qu’il a appris. Le candidat ne connait pas les produits mis en oeuvre, ce qui se ressent par une démarche très incertaine. Il ne trouve pas les fonctionnalités demandées ou uniquement après une longue recherche. Il utilise les produits nécessaires de manière erronée ou ne les utilise pas du tout. "
      },
      {
        id: "A10",
        title: "Utilisation du jargon / terminologie métier appropriée ",
        help: "Le vocabulaire technique sert à expliquer des situations ou contenus spécifiques. L’utilisation de termes spécialisés est conforme à leur acception et correcte. Le ou la candidat-e est à même d’expliquer de façon compréhensible les termes techniques et acronymes utilisés.<br><h3>Niveau de qualité 3</h3>1. Le candidat utilise systématiquement la terminologie appropriée et usuelle de la profession pour expliquer les situations spécifiques.<br>2. Dans ce cadre, les termes techniques sont utilisés correctement et de manière précise.<br>3. Les termes et acronymes sont utilisés au bon endroit et peuvent être expliqués par le candidat sur demande.<br>4. L’explication des termes techniques est irréprochable.<br><h3>Niveau de qualité 2</h3>Trois des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Deux des points mentionnés sont remplis ou les quatre sont remplis partiellement.<br><h3>Niveau de qualité 0</h3> Un seul ou aucun des points mentionnés n’est rempli. "
      },
      {
        id: "A11",
        title: "Procédure de travail et méthode professionnelle ",
        help: "La bonne procédure de travail et une méthode professionnelle appropriée sont appliquées aux différentes tâches à effectuer.<br><h3>Niveau de qualité 3</h3>Choisit des méthodes et techniques appropriées aux tâches concernées. Celles-ci sont mise en œuvre correctement et dans leur intégralité.<br><h3>Niveau de qualité 2</h3>Les méthodes sont appropriées et correctes mais mises en œuvre de manière incomplète.<br><h3>Niveau de qualité 1</h3>Les méthodes sont appropriées mais pas mises en œuvre correctement.<br><h3>Niveau de qualité 0</h3> Pas de choix ou choix inapproprié de méthodes et techniques. "
      },
      {
        id: "A12",
        title: "Organisation des résultats du travail ",
        help: "Un classement des documents systématique et bien organisé permet d’exploiter au mieux les résultats du travail (documentation, code source, manuels, etc.). Afin de pouvoir accéder en tout temps aux résultats, le ou la candidat-e organise et sauvegarde ses documents. Une organisation correcte se reflétera ensuite dans la documentation.<br><h3>Niveau de qualité 3</h3>1. La gestion des versions des résultats du travail est correcte et reflète bien l’état de développement et permet de retrouver chaque version précédente.<br>2. L’organisation des documents permet de retrouver et de disposer de chaque version différente.<br>3. Les résultats du travail (documentation, code, manuels, etc.) sont enregistrés au moins une fois par jour.<br>4. La restauration des documents enregistrée est assurée.<br>5. L’ergonomie de la place de travail (physique et informatique) a été prise en compte. Elle est mise en place en fonction des besoins tout au long du TPI.<br>6. Les points 1 à 5 sont tous décrits et retraçables dans le rapport du TPI.<br><h3>Niveau de qualité 2</h3>Cinq des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Quatre des points mentionnés sont remplis.<br><h3>Niveau de qualité 0</h3> Trois points mentionnés ou moins sont remplis. "
      },
      {
        id: "A13",
        title: "Performance ",
        help: "L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>L'efficacité/la performance du candidat ainsi que l’étendue et le dégré de finition/réalisation du produit correspondent au résultat attendu d'un professionnel du métier. Tout le potentiel à retirer de la donnée du problème du TPI ressort clairement et a été réalisé dans le temps imparti par le cahier des charges.<br><h3>Niveau de qualité 2</h3>L’étendue et le degré de finition/réalisation du produit correspondent au résultat d’un professionnel du métier. Le potentiel de la donnée du problème du TPI a été correctement réalisé dans les temps.<br><h3>Niveau de qualité 1</h3>L’étendue et le degré de finition/réalisation du produit correspondent partiellement au résultat attendu d’un professionnel du métier. Le potentiel de la donnée du problème n’a été que partiellement réalisé dans le temps imparti.<br><h3>Niveau de qualité 0</h3> L’étendue et le degré de finition/réalisation du produit ne correspondent en grande partie pas au résultat attendu d’un professionnel. Le potentiel de la donnée du problème n’a pas été mis en oeuvre dans le temps imparti ou que dans certains cas. "
      },
      {
        id: "A14",
        title: "Point techniques évalués spécifiques au projet (Point 8.1 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A15",
        title: "Point techniques évalués spécifiques au projet (Point 8.2 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A16",
        title: "Point techniques évalués spécifiques au projet (Point 8.3 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A17",
        title: "Point techniques évalués spécifiques au projet (Point 8.4 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A18",
        title: "Point techniques évalués spécifiques au projet (Point 8.5 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A19",
        title: "Point techniques évalués spécifiques au projet (Point 8.6 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "A20",
        title: "Point techniques évalués spécifiques au projet (Point 8.7 du CdC) ",
        help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. "
      },
      {
        id: "B1",
        title: "Résumé du rapport du TPI / version succincte de la doc.",
        help: "Un résumé conceptuel du travail effectué et du résultat obtenu permet aux lecteurs impliqués dans le projet (supérieur, experts) de mieux comprendre le travail fourni. La version succincte ne contient pas de graphiques, mais uniquement du texte.  <br> <h3>Niveau de qualité 3 </h3>1. Le résumé est destiné à un public professionnel de la branche (langage, style, niveau de détail et termes techniques utilisés)<br>2. Il contient trois paragraphes : Situation de départ, mise en œuvre, résultats.  <br>3. Le résumé contient pour l'ensemble des points précités que des aspects essentiels.<br>4. Il n'est pas plus long qu'une page A4 de texte et ne contient pas de graphiques  <br> <h3>Niveau de qualité 2 </h3>Trois des points sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points sont remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux points sont remplis."
      },
      {
        id: "B2",
        title: "Tenue du journal de travail ",
        help: "Le journal de travail sert à documenter les activités quotidiennes, les problèmes rencontrés ainsi que les éventuels travaux imprévus, aides et heures supplémentaires. Il est clairement structuré et se réfère au plan du projet.  <br> <h3>Niveau de qualité 3 </h3>1. La structure et la présentation sont claires. <br>2. Toutes les activités planifiées ainsi que les imprévus et les heures supplémentaires y sont mentionnés. <br>3. Les succès et les échecs sont mentionnés. <br>4. Le travail journalier et son appréciation critique y figurent.  <br> <h3>Niveau de qualité 2 </h3>Trois des points d'évaluation sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux points d'évaluation sont remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux exigences sont remplies ou l'aide de la part d'une personne tierce n'est pas mentionnée ou de toute évidence les heures supplémentaires effectuées ne sont pas mentionnées. "
      },
      {
        id: "B3",
        title: "Capacité de réflexion ",
        help: "La réflexion est la capacité de la personne en formation d'analyser la manière dont elle a exécuté la tâche dans son ensemble et d'identifier les points où elle pourrait s'améliorer. Ces constats sont documentés dans le journal de travail et dans la conclusion.  <br> <h3>Niveau de qualité 3 </h3>1. Le rapport contient une réflexion critique du candidat sur l'approche qu'il a suivie et les résultats obtenus.<br>2. Compare les variantes de solutions possibles ou justifie pourquoi il n'y a pas de variantes.  <br>3. Tire ses propres conclusions qui reflètent sa réflexion.<br>4. Le mot de la fin/la conclusion comprend un bilan personnel.  <br> <h3>Niveau de qualité 2 </h3>Trois des points cités sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points cités sont remplis ou les quatre points sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Un ou aucun des points mentionnés n'est rempli. "
      },
      {
        id: "B4",
        title: "Structure ",
        help: "Une documentation est compréhensible lorsqu'elle est conçue de manière claire pour un spécialiste extérieur. Les diverses étapes suivent un fil rouge et présentent une structure cohérente.  <br> <h3>Niveau de qualité 3 </h3>1. La documentation est divisée en chapitres en rapport avec les thèmes et les points principaux du projet.<br>2. La documentation est clairement structurée et les titres utilisés contiennent un contenu approprié.  <br>3. L'ordre des thèmes traités dans la documentation est bien coordonné.<br>4. La conception des titres, textes et graphiques simplifie la lecture du rapport et ne l'entrave en aucun cas.  <br> <h3>Niveau de qualité 2 </h3>Trois des points cités sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points cités sont remplis ou les quatre points sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Un ou aucun des points cités n'est rempli."
      },
      {
        id: "B5",
        title: "Pertinence ",
        help: "L'auteur de la documentation va à l'essentiel en fournissant toutes les informations pertinentes sans entrer dans des détails superflus.  <br> <h3>Niveau de qualité 3 </h3>Le texte du rapport du TPI est conçu de façon optimale et les informations sont concises et les plus pertinentes possibles. Il comprend une suite logique et ne contient pas plus de détails que nécessaire à une exception près si cela est nécessaire à la compréhension d'un thème. Il ne contient pas d'informations superflues de \"\"remplissage\"\".  <br> <h3>Niveau de qualité 2 </h3>Le texte du rapport contient au maximum pour deux points (sous-chapitres) les faiblesses suivantes : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes.  <br> <h3>Niveau de qualité 1</h3>Le texte du rapport contient les faiblesses suivantes pour trois points au maximum : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes.  <br> <h3>Niveau de qualité 0</h3>Le texte du rapport contient au maximum pour plus de trois points (sous- chapitres) les faiblesses suivantes : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes. "
      },
      {
        id: "B6",
        title: "Respect des prescriptions formelles du rapport du TPI ",
        help: "Il s'agit ici d'évaluer le caractère exhaustif de la documentation du point de vue formel, conformément aux prescriptions de l'expert en chef cantonal.  <br> <h3>Niveau de qualité 3 </h3>1. La mise en page et le contenu du PDF et du fichier Word/de la version imprimée sont identiques<br>2. Le rapport est séparé en deux parties distinctes. Le code source est annexé.  <br>3. Le rapport contient : L'organisation du projet, le journal, le planning.  <br>4. Le rapport du TPI contient une table des matières à jour (num. page etc.).<br>5. Le rapport contient une liste des sources et références complète et structurée.  <br>6. Le rapport du TPI contient un entête et un pied de page sur toutes les pages comprenant la date d'impression et le nom du candidat.<br>7. Le rapport du TPI contient un glossaire trié alphabétiquement comprenant les termes spécifiques au TPI.  <br> <h3>Niveau de qualité 2 </h3>Le point 1 et 5 autres points sont entièrement remplis.  <br> <h3>Niveau de qualité 1</h3>Le point 1 et au moins 3 autres sont remplis.  <br> <h3>Niveau de qualité 0</h3>Le niveau de qualité 1 n'est pas atteint ou moins de cinq points sont atteints."
      },
      {
        id: "B7",
        title: "Expression écrite et style / orthographe et grammaire",
        help: "L'expression écrite est un vecteur essentiel de transmission et de compréhension des informations et des résultats. Lorsqu'ils sont utilisés à bon escient, de manière correcte et en adéquation avec les destinataires (p. ex. département informatique, spécialistes, tierces personnes), les termes techniques constituent une aide précieuse à la communication pour les informaticiens. L'orthographe influe fortement sur la lisibilité et la compréhensibilité du texte. Un travail soigneux et l'utilisation appropriée des dictionnaires et des outils de correction grammaticale permettent d'éviter les fautes d'orthographe.  <br> <h3>Niveau de qualité 3 </h3>	1.	Le langage utilisé est clair et compréhensible (structure des phrases, ordre des mots utilisés) dans l'entier du rapport du TPI, écrit dans un style fluide avec des phrases complètes et parfaitement formulées.   <br>	2.	Les termes techniques sont utilisés correctement et dans le registre approprié.   <br>	3.	Le rapport du TPI contient peu d'erreur d'orthographe ou de grammaire.   <br>	4.	Les correcteurs électroniques d'orthographe et de grammaire ont été utilisés.   <h3>Niveau de qualité 2 </h3>Trois des points mentionnés sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points mentionnés sont remplis ou trois sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Uniquement un point est rempli ou tous les points sont remplis partiellement. "
      },
      {
        id: "B8",
        title: "Présentation ",
        help: "La documentation est la carte de visite du travail pratique. Sa présentation témoigne de la cohérence et de l'adéquation du travail du ou de la candidat-e.  <br> <h3>Niveau de qualité 3 </h3>	1.	La présentation contient une numérotation des pages appropriée.   <br>	2.	Le saut de page est utilisé de manière appropriée ou n'entrave pas le  flux de la lecture du rapport.   <br>	3.	Chaque page contient des informations et pas seulement une ligne de  texte ou de titre.   <br>	4.	La présentation est appropriée et propre.   <h3>Niveau de qualité 2 </h3>Trois points sont remplis.  <h3>Niveau de qualité 1</h3>Deux points sont remplis.  <h3>Niveau de qualité 0</h3>Moins de deux points sont remplis. "
      },
      {
        id: "B9",
        title: "Graphiques, images, diagrammes et tableaux ",
        help: "Les graphiques, images, diagrammes et tableaux servent à présenter une matière complexe, à la rendre compréhensible ou à la structurer.  <br> <h3>Niveau de qualité 3 </h3>	1.	Des graphiques, images, diagrammes ou des tableaux sont utilisés aux endroits adéquats et permettent de mieux se représenter le contenu du rapport du TPI et rendre le texte plus compréhensible.   <br>	2.	Le choix du schéma/de la représentation est approprié dans l'entier du TPI.   <br>	3.	Les images sont visuellement lisibles   <br>	4.	Les images sont compréhensibles au niveau du contenu.   <br>	5.	Les illustrations sont pertinentes et représentatives.   <br>	6.	Les illustrations sont expliquées dans une légende ou un texte.   <br>	7.	Les illustrations sont appropriées au contexte.   <h3>Niveau de qualité 2 </h3>6 aspects sont bien remplis.  <h3>Niveau de qualité 1</h3>4 aspects sont bien remplis.  <h3>Niveau de qualité 0</h3>Moins de 4 aspects sont bien remplis."
      },
      {
        id: "B10",
        title: "Documentation de la procédure de tests et de ses résultats ",
        help: "Les résultats des tests sont compréhensibles et reproductibles lorsque l'installation de test, les méthodes et les outils utilisés à cet effet sont décrits de telle manière que des spécialistes externes puissent exécuter eux-mêmes la procédure. Tous les tests, prévus ou imprévus, sont documentés.  <br> <h3>Niveau de qualité 3 </h3>	1.	Le protocole de tests est basé sur l'équipement de test, les scénarios de tests et les moyens d'aide à disposition.   <br>	2.	Il est facilement compréhensible.   <br>	3.	Les actions et les paramètres sont décrits sans aucune ambiguité.   <br>	4.	Tous les résultats des tests sont documentés.   <h3>Niveau de qualité 2 </h3>Trois des aspects sont bien remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des aspects sont bien remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux aspects sont bien remplis."
      },
      {
        id: "C1",
        title: "Gestion du temps, structure ",
        help: "La structure et le contenu de la présentation se limitent aux principaux aspects (tâches, déroulement, résultats) du TPI. Le temps imparti pour la présentation doit être respecté.<h3>Niveau de qualité 3</h3>1. La présentation comporte une introduction avec un bref aperçu qui fait le lien avec la suite de la présentation et contient donc une partie centrale ainsi qu'une conclusion comprenant une évaluation critique du travail effectué.<br>2. La présentation fait ressortir les aspects essentiels du résultat du TPI.<br>3. La présentation se concentre sur les aspects pertinents.<br>4. La présentation est faite dans un ordre logique et construite de manière cohérente.<br>5. Le temps de présentation est strictement respecté.<br><h3>Niveau de qualité 2</h3>Trois points des points 1 à 4 sont remplis ou le temps de présentation n'a pas été dépassé de plus de 2 minutes.<br><h3>Niveau de qualité 1</h3>Deux points des points 1 à 4 sont respectés ou le temps de présentation n'a pas été dépassé ou été inférieur de plus de 4 minutes.<br><h3>Niveau de qualité 0</h3>Un seul point des points 1 à 4 est rempli ou le temps de présentation a été dépassé ou été inférieur de plus de 4 minutes."
      },
      {
        id: "C2",
        title: "Présentation : Utilisation de médias, aspects techniques ",
        help: "Pour la présentation du projet, des outils techniques<br>sont utilisés seuls ou en combinaison. Le ou la candidat-e doit savoir les utiliser correctement et à bon escient.<h3>Niveau de qualité 3</h3>1. Utilise les moyens techniques appropriés pour appuyer la présentation<br>2. Utilise correctement les moyens techniques à disposition.<br>3. Le langage et les médias utilisés sont idéalement choisis et se complètent parfaitement.<br><h3>Niveau de qualité 2</h3>Deux des points mentionnés sont remplis ou deux points sont partiellement remplis.<br><h3>Niveau de qualité 1</h3>Un des points mentionnés est rempli ou trois points sont partiellement remplis.<br><h3>Niveau de qualité 0</h3>Aucun des points mentionnés n'est rempli."
      },
      {
        id: "C3",
        title: "Technique de présentation ",
        help: "La présentation se fait dans la langue employée à l'école. Le ou la candidat-e doit formuler des phrases correctes et intelligibles. Les formulations et le langage technique sont en adéquation avec le public cible (spécialistes, experts). Le volume de la voix, la vitesse d'élocution ainsi que la gestuelle sont adaptés au public cible et aux locaux.<br><h3>Niveau de qualité 3</h3>1. Les déclarations sont parfaitement formulées.<br>2. Les phrases sont formulées de manière claire, complète et linguistiquement correcte.<br>3. La discussion est claire.<br>4. La gestuelle/les mimiques sont adaptées au public cible.<br>5. Un contact visuel fréquent est visible et ce avec tous les auditeurs.<br><h3>Niveau de qualité 2</h3>Quatre points sont remplis. <br><h3>Niveau de qualité 1</h3>Trois points sont remplis.<br><h3>Niveau de qualité 0</h3>Deux points ou moins de deux points sont remplis."
      },
      {
        id: "C4",
        title: "Echange d'information avec les experts durant le TPI ",
        help: "L'échange d'informations entre le candidat et les experts s'est fait correctement durant toute la procédure du TPI<br><h3>Niveau de qualité 3</h3>Le candidat a toujours répondu durant le TPI dans un délai acceptable aux questions et demandes des experts.<br>Le candidat a envoyé à chaque échéance les documents demandés<br><h3>Niveau de qualité 2</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais entre une et deux fois.<br><h3>Niveau de qualité 1</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais entre trois et quatre fois.<br><h3>Niveau de qualité 0</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais plus de quatre fois."
      },
      {
        id: "C5",
        title: "Question des experts 1",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "C6",
        title: "Question des experts 2",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "C7",
        title: "Question des experts 3",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "C8",
        title: "Question des experts 4",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "C9",
        title: "Question des experts 5",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "C10",
        title: "Question des experts 6",
        help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen."
      },
      {
        id: "X99",
        title: "Aide TPI-Eval",
        help: "<h3>TPI-Eval</h3><ul><li>S'il y a un ou plusieurs fichiers 'eval*.js' dans le dossier, tu peux en recharger un grâce à la dropdown list</li><li>Sinon tu peux partir sur une grille vierge avec le bouton</li><li>Tu remplis les champs grisés (les champs de justification sont extensibles)</li><li>Quand tu as un doute, tu cliques sur le numéro du critère ou tu presse F1, et ... zbang! (Escape referme l'aide)</li><li>Tu enregistre un état intermédiaire avec le bouton 'Enregistrer'. Cela a pour effet de télécharger un fichier 'eval\<x>.js'. <span class:bold>Déplace ce fichier dans le dossier de TPI-Eval (remplace l'existant)</span></li><li>Quand c'est fini, tu cliques 'finaliser', ça télécharge un ficher 'Eval TPI - \<candidat>.js et la met en lecture seule</li><li>Tu l'imprimes depuis le navigateur</li></ul>"
      }
    ];
    let tabindex = 20; // Leave some room for header fields
    var helpcontext; // The id of the criteria on which help must be provided when F1 is hit
    document.addEventListener("keydown", function (e) {
      if (e.key == "F1" && e.shiftKey) showModal(helpcontext);
      if (e.key == "Escape") modal.style.display = "none";
    });

    // Build the tables in sections A, B and C
    for (item of criteria) {
      let r = document.createElement("div");
      r.className = "row";
      r.id = "row" + item.id;

      // id cell
      let cid = document.createElement("div");
      cid.className = "cell col-1";
      cid.innerText = item.id;
      cid.id = item.id;
      cid.addEventListener("click", function (e) {
        showModal(e.target.id);
      });

      // name cell
      let cname = document.createElement("div");
      cname.className = "cell col-7";
      cname.innerText = item.title;
      cname.id = "nam" + item.id;

      // Add text input for specific criteria
      if (item.id.charAt(0) == "A" && parseInt(item.id.substring(1)) >= 14 && parseInt(item.id.substring(1)) <= 20) {
        let desccrit = document.createElement("input");
        desccrit.type = "text";
        desccrit.id = "csp" + item.id;
        desccrit.tabIndex = tabindex++;
        desccrit.addEventListener("focus", function (e) {
          helpcontext = e.target.id.substring(3);
        });
        cname.appendChild(desccrit);
      }

      // Add text input for the question
      if (item.id.charAt(0) == "C" && parseInt(item.id.substring(1)) >= 5) {
        let question = document.createElement("textarea");
        question.id = "qst" + item.id;
        question.className = "question"; // no styling used for add/remove questions
        question.tabIndex = tabindex++;
        question.addEventListener("focus", function (e) {
          helpcontext = e.target.id.substring(3);
        });
        cname.appendChild(question);
      }

      // Points
      let cpts = document.createElement("div");
      cpts.className = "cell col-1 center";
      let numcpts = document.createElement("input");
      numcpts.className = "points";
      numcpts.type = "number";
      numcpts.min = 0;
      numcpts.max = 3;
      numcpts.id = "pts" + item.id;
      numcpts.tabIndex = tabindex++;
      numcpts.addEventListener("focus", function (e) {
        helpcontext = e.target.id.substring(3);
      });
      cpts.appendChild(numcpts);

      // justification cell
      let cjust = document.createElement("div");
      cjust.className = "cell col-7 center";
      let txtjust = document.createElement("textarea");
      txtjust.id = "jus" + item.id;
      txtjust.type = "text";
      txtjust.tabIndex = tabindex++;
      txtjust.addEventListener("focus", function (e) {
        helpcontext = e.target.id.substring(3);
      });
      cjust.appendChild(txtjust);

      // finalize row
      r.appendChild(cid);
      r.appendChild(cname);
      r.appendChild(cpts);
      r.appendChild(cjust);

      // add row to the appropriate table
      switch (item.id.charAt(0)) {
        case "A":
          tblProComp.appendChild(r);
          break;
        case "B":
          tblDoc.appendChild(r);
          break;
        case "C":
          tblPres.appendChild(r);
          break;
      }
    }

    // setup event handler for add question button
    cmdAddQuestion.addEventListener("click", () => {
      duplicateLastQuestionRow();
    });

    function duplicateLastQuestionRow() {
      let allQuestions = document.getElementsByClassName("question");
      let lastQuestion = allQuestions[allQuestions.length - 1];
      // duplicate and adjust the last question row
      let lastQuestionRow = lastQuestion.parentNode.parentNode;
      let newQuestionRow = shiftQuestionRow(lastQuestionRow);
      // Set event handler on points (not copied in cloning operation)
      newQuestionRow.childNodes[2].childNodes[0].addEventListener("change", function (e) {
        checkInputPoints(e.target);
      });
      lastQuestionRow.parentNode.appendChild(newQuestionRow);
      criteria.push({ id: newQuestionRow.id.substring(3) }); // so that it will be saved
      addRemoveButtons();
    }

    // Increment all internal ids of the question and returns the result row
    function shiftQuestionRow(row) {
      let res = row.cloneNode(true); // deep clone
      let rowid = parseInt(row.id.substring(4)) + 1; // id for new row
      let tabindex = parseInt(row.childNodes[1].childNodes[1].tabIndex) + 3;
      res.id = "rowC" + rowid;
      res.childNodes[0].innerText = "C" + rowid;
      res.childNodes[0].id = "C" + rowid;
      res.childNodes[1].childNodes[0].nodeValue = "Question des experts " + (rowid - 4);
      res.childNodes[1].childNodes[1].id = "qstC" + rowid;
      res.childNodes[1].childNodes[1].value = "";
      res.childNodes[1].childNodes[1].tabIndex = tabindex++;
      res.childNodes[2].childNodes[0].id = "ptsC" + rowid;
      res.childNodes[2].childNodes[0].value = null;
      res.childNodes[2].childNodes[0].tabIndex = tabindex++;
      res.childNodes[3].childNodes[0].id = "jusC" + rowid;
      res.childNodes[3].childNodes[0].value = "";
      res.childNodes[3].childNodes[0].tabIndex = tabindex++;
      res.childNodes[3].childNodes[0].tabindex = 100 + rowid;
      return res;
    }

    // setup event handlers that will keep the grade accurate
    for (inputpoints of document.getElementsByClassName("points")) {
      inputpoints.addEventListener("change", function (e) {
        checkInputPoints(e.target);
      });
    }

    function checkInputPoints(input) {
      if (input.value > 3) input.value = 3;
      if (input.value < 0) input.value = 0;
      computeGrade();
    }

    // Compute and display the grades, doing sub totals per part
    function computeGrade() {
      let totalA = 0;
      let totalB = 0;
      let totalC = 0;
      for (inputpoints of document.getElementsByClassName("points")) {
        if (inputpoints.value > 0)
          switch (inputpoints.parentNode.parentNode.parentNode.dataset.part) {
            case "A":
              totalA += parseInt(inputpoints.value);
              break;
            case "B":
              totalB += parseInt(inputpoints.value);
              break;
            case "C":
              totalC += parseInt(inputpoints.value);
              break;
          }
      }
      divTotalA.innerText = totalA;
      divTotalB.innerText = totalB;
      divTotalC.innerText = totalC;
      let total = totalA + totalB + totalC;
      divTotal.innerText = total;
      let grade = (total / 120.0) * 5 + 1;
      divGrade.innerText = grade.toFixed(1);
      isCloseable();
    }

    // propagate the candidate name in the sheet and workspace
    function contextualize() {
      spnCandidate.innerText = txtCandidate.value;
      document.title = txtCandidate.value;
    }
    //
    txtCandidate.addEventListener("change", function () {
      contextualize();
    });

    var currentIndex = -1; // Index of the eval selected. Remember for save
    dpdEvalSelector.addEventListener("change", function () {
      divSelector.className = "d-none";
      divPage.classList.remove("d-none");
      currentIndex = dpdEvalSelector.value;
      load(evals[currentIndex]);
    });

    cmdEmpty.addEventListener("click", function () {
      divSelector.className = "d-none";
      divPage.classList.remove("d-none");
      // autosave: call saveData upon change of any input or textarea field
      for (input of document.querySelectorAll("input, textarea")) {
        input.addEventListener("blur", function () {
          saveData(false);
        });
      }
      isCloseable();
    });
    // Finalize sheet by turning all inputs into their text value
    cmdFreeze.addEventListener("click", function () {
      if (isCloseable()) {
        cmdFreeze.style.display = "none"; // so the save function knows it's frozen
        saveData(true);
        freezeSheet();
      }
    });

    function freezeSheet() {
      freezeInputs(document.getElementsByTagName("input"));
      freezeInputs(document.getElementsByTagName("textarea"));
      cmdFreeze.style.display = "none";
    }

    function freezeInputs(inputs) {
      // Work backwards on the list because we are going to destroy the elements
      for (i = inputs.length - 1; i >= 0; i--) {
        let input = inputs[i];
        let parent = input.parentNode;
        let val = document.createElement("div");
        val.className = "value";
        if (input.type == "number") val.classList.add("center");
        val.innerText = input.value;
        parent.removeChild(input);
        parent.appendChild(val);
      }
    }

    // dispatch the data into the field
    function load(data) {
      // cartouche
      txtBoss.value = data.cartouche.boss.name;
      txtBossPhone.value = data.cartouche.boss.phone;
      txtBossMail.value = data.cartouche.boss.mail;
      txtCandidate.value = data.cartouche.candidate.name;
      txtCandidatePhone.value = data.cartouche.candidate.phone;
      txtCandidateMail.value = data.cartouche.candidate.mail;
      txtExpert1.value = data.cartouche.expert1.name;
      txtExpert1Phone.value = data.cartouche.expert1.phone;
      txtExpert1Mail.value = data.cartouche.expert1.mail;
      txtExpert2.value = data.cartouche.expert2.name;
      txtExpert2Phone.value = data.cartouche.expert2.phone;
      txtExpert2Mail.value = data.cartouche.expert2.mail;

      // questions
      i = 5;
      while (typeof data.questions[i - 5] != "undefined") {
        if (i > 10) {
          // the row does not exist --> create it
          duplicateLastQuestionRow();
        }
        document.getElementById("qstC" + i).value = data.questions[i - 5];
        i++;
      }

      // criteria
      for (crit of data.criteria) {
        document.getElementById("pts" + crit.id).value = crit.points;
        document.getElementById("jus" + crit.id).value = crit.justification;
      }
      computeGrade();

      // Text of specific criteria
      for (i = 14; i <= 20; i++) {
        document.getElementById("cspA" + i).value = data.specifics[i - 14];
      }

      // remarks
      txtRemarks.value = data.remarks;

      contextualize();

      if (data.frozen) freezeSheet();

      // autosave: call saveData upon change of any input or textarea field
      for (input of document.querySelectorAll("input, textarea")) {
        input.addEventListener("blur", function () {
          saveData(false);
        });
      }
      // autoresize textareas
      for (ta of document.getElementsByTagName("textarea")) {
        ta.style.height = ta.scrollHeight + "px";
        ta.addEventListener("blur", function () {
          this.style.height = this.scrollHeight + "px";
        });
      }
    }

    // Add the remove buttons to all questions if there are more than 6 questions
    function addRemoveButtons() {
      let questions = document.querySelectorAll('[id^="namC"]');
      removeRemoveButtons();
      if (questions.length > 10) {
        // too many questions
        for (i = 4; i <= questions.length - 1; i++) {
          // start at 4 to ignore the first Cxx criteria that are not questions
          let delButton = document.createElement("button");
          delButton.innerText = "✖";
          delButton.id = "delQ" + (i + 1);
          delButton.className = "delbutton";
          delButton.addEventListener("click", (e) => {
            deleteQuestion(e.target.id.substring(4));
          });
          questions[i].appendChild(delButton);
        }
      }
    }

    // remove all delete buttons
    function removeRemoveButtons() {
      let buttons = document.getElementsByClassName("delbutton");
      for (i = buttons.length - 1; i >= 0; i--) {
        buttons[i].remove();
      }
      criteria.pop(); // for proper saving
    }

    // handle delete button click
    function deleteQuestion(qid) {
      let qsts = document.querySelectorAll('[id^="qstC"]');
      let ptss = document.querySelectorAll('[id^="ptsC"]');
      let juss = document.querySelectorAll('[id^="jusC"]');
      // shift fields content up
      for (i = qid - 5; i < qsts.length - 1; i++) {
        qsts[i].value = qsts[i + 1].value;
        ptss[i + 4].value = ptss[i + 5].value;
        juss[i + 4].value = juss[i + 5].value;
      }
      // Now remove last line
      document.getElementById("rowC" + (qsts.length + 4)).remove();
      addRemoveButtons(); // in case they are no longer needed
      computeGrade(); // we may have deleted points
    }

    function isCloseable() {
      let inputPoints = document.getElementsByClassName("points");
      let res = true; // assumption
      if (inputPoints.length > 40) {
        cmdFreeze.title = "Il reste trop de questions dans la section C";
        res = false;
      } else {
        for (input of inputPoints) {
          if (input.value == "") {
            res = false;
            cmdFreeze.title = "Certains critères n'ont pas de points attribués";
          }
        }
      }
      if (res) {
        cmdFreeze.title = "Met l'évaluation en lecture seule et télécharge le fichier sour le nom du candidat";
        cmdFreeze.className = "button";
      } else {
        cmdFreeze.className = "disabledbutton";
      }
      return res;
    }

    cmdExport.addEventListener("click", function () {
      var dataStr = "data:text/json;charset=utf-8, " + encodeURIComponent(JSON.stringify(evals));
      var downloadAnchorNode = document.createElement("a");
      downloadAnchorNode.setAttribute("href", dataStr);
      downloadAnchorNode.setAttribute("download", "TPIEval_export.json");
      document.body.appendChild(downloadAnchorNode);
      downloadAnchorNode.click();
      downloadAnchorNode.remove();
    });

    function saveData(final, autosave = false) {
      data = {
        frozen: final,
        cartouche: {
          boss: { name: txtBoss.value, phone: txtBossPhone.value, mail: txtBossMail.value },
          candidate: { name: txtCandidate.value, phone: txtCandidatePhone.value, mail: txtCandidateMail.value },
          expert1: { name: txtExpert1.value, phone: txtExpert1Phone.value, mail: txtExpert1Mail.value },
          expert2: { name: txtExpert2.value, phone: txtExpert2Phone.value, mail: txtExpert2Mail.value }
        }
      };

      // build the criteria part
      data.criteria = [];
      for (crit of criteria) {
        if (crit.id.charAt(0) != "X") {
          data.criteria.push({
            id: crit.id,
            points: document.getElementById("pts" + crit.id).value,
            justification: document.getElementById("jus" + crit.id).value
          });
        }
      }

      // specific criteria
      data.specifics = [];
      for (i = 14; i <= 20; i++) {
        data.specifics.push(document.getElementById("cspA" + i).value);
      }

      // questions
      data.questions = [];
      i = 5;
      while ((q = document.getElementById("qstC" + i++))) {
        data.questions.push(q.value);
      }

      // add remarks
      data.remarks = txtRemarks.value;

      // Store in localStorage
      if (currentIndex >= 0) {
        evals[currentIndex] = data;
      } else {
        evals.push(data);
      }
      localStorage.setItem("evals", JSON.stringify(evals));
    }

    // Handling of modal popup, from w3schools
    // Get the modal
    var modal = document.getElementById("popup");

    // Open the modal on click on criteria id
    var btn = document.getElementById("myBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    function showModal(cid) {
      if (typeof cid == "undefined") cid = "X99"; // General help
      let crit = criteria.find((c) => {
        return c.id === cid;
      });
      divModalContent.innerHTML = crit.help;
      modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
      modal.style.display = "none";
    };

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };
  </script>
</html>
